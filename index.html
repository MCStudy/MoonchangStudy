<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <script src="http://code.jquery.com/jquery-1.11.3.min.js"></script>
    <!-- server -->
    <script>
      var viewRank = function(){
        $.ajax({
          dataType: 'jsonp',
          jsonp: 'callback',
          url: 'http://nupa.fun25.co.kr:17903/view',
          success: function(data) {
            var text = '<table id=rank-table cellspacing=15>';
            text += '<tr>';
            text += '<td> rank </td><td> name </td><td> level </td><td> time </td>';
            text += '</tr>';
            for(var i in data){
              var levelName = {
                1:'Debut',
                2:'Regular',
                3:'Pro',
                4:'Master',
                5:'Master+'
              }[data[i].level];
              text += '<tr>';
              text += '<td>' +(i*1+1)+ '</td><td>' + data[i].player +'</td><td>'+ levelName +'</td><td>'+ data[i].time/1000 + 's </td>';
              text += '</tr>';
            }
            text += '</table>';
            $('#rank-container').html(text);
          }
        });
      };
    </script>
    <style>
      .container{
        width: 800px;
      }
      #button-container{
        position: absolute;
        width: 400px;
        height: 50px;
      }
      .button{
        margin: 10px;
        color: #aaa;
        font-size: 20;
        transition: 0.3s;
      }
      .button-disable{
        margin: 10px;
        color: #aaa;
        font-size: 20;
        cursor: pointer;
      }
      .button:hover {
        color:#fff;
        cursor: pointer;
        font-size: 24;
      }

      #rank-table{
        margin: 30px;
      }
    </style>
  </head>
<body>

<center>
<div class="container">
  <div style="font-size:5">
    <p>이 게임은 학습을 목적으로 개발되었으며 영리적인 목적은 가지고 있지 않습니다. 일부 이미지의 저작권은 '주식회사 반다이남코 엔터테이먼트'에 있습니다.</p>
    <p>このゲームは、学習を目的に開発され、営利的な目的は持っていません。一部の画像の著作権は、「株式会社バンダイナムコエンターテインメント」にあります。</p>
  </div>

  <canvas id="canvas" width=800 height=600></canvas>

  <div id="button-container" style="top:400px;">
    <div class="button">Debut</div>
    <div class="button-disable">Regular</div>
    <div class="button-disable">Pro</div>
    <div class="button-disable">Master</div>
    <div class="button-disable">Master+</div>
  </div>
  <br>
  <div id="rank-container">

  </div>
</div>
</center>

<div id="bgm" style="visibility: hidden;">
  <iframe width="300" height="25" src="http://www.youtube.com/embed/vE8Df0k-mD4?autoplay=1&playlist=vE8Df0k-mD4&loop=1&showinfo=0&fs=0&rel=0" frameborder="0" allowfullscreen></iframe>
</div>

</body>


<!-- game -->
<script src="resource.js"></script>
<script src="lib/engine.js"></script>
<script src="monster/Weed.js"></script>
<script src="monster/Bat.js"></script>
<script src="monster/Mouse.js"></script>
<script src="monster/Beetle.js"></script>
<script src="monster/Piece.js"></script>
<script src="map/Map.js"></script>

<script src="game.js"></script>
<script>

clearStage = localStorage.getItem('clearStage') || 0;
viewRank();

for(var i=0; i<clearStage; i++){
  if($('.button-disable')[0])
    $('.button-disable')[0].className = 'button';
};

var intro = new Sprite(function(my){
  my.width = 800;
  my.height = 600;
  my.collision = false;
  my.tag = 'background';

  my.renderer(function(){
    ctx.font = "30px Arial";
    ctx.fillText("Loading...",10,50);
    ctx.drawImage(resource.bg1, my.x, my.y, my.width, my.height);
    ctx.drawImage(resource.intro, my.x, my.y, my.width, my.height);
  });

  my.draw(0, 0);
});

$('.button').click(function(){
  var level = {
    'Debut': 1,
    'Regular': 2,
    'Pro': 3,
    'Master': 4,
    'Master+' : 5
  }[$(this).text()];

  $('#button-container').hide();

  intro.dead();
  gameStart(level);

  $('#bgm').html('<iframe width="300" height="25" src="http://www.youtube.com/embed/zBgy4lrOdt4?autoplay=1&playlist=zBgy4lrOdt4&loop=1&showinfo=0&fs=0&rel=0" frameborder="0" allowfullscreen></iframe>');
});
</script>

</html>
